{"version":3,"sources":["webpack://exports/webpack/bootstrap","webpack://exports/./src/methods/buildPaletteCell.js","webpack://exports/./src/methods/updatePaletteItem.js","webpack://exports/./src/onColorChange.js","webpack://exports/./src/utils/constants.js","webpack://exports/./src/utils/loc.js","webpack://exports/./src/utils/strings.js","webpack://exports/external \"sketch\""],"names":["buildCellText","color","usages","thicknesses","localCoordinates","thicknessPrefix","join","opacity","parseInt","substring","opacitySuffix","toFixed","usagesString","type","sketch","Types","Text","text","frame","Rectangle","y","style","fontSize","fontFamily","borders","buildPaletteCell","coordinates","sharedKeys","colorLayers","colorArr","colorFills","colorBorders","includes","whiteBg","ShapePath","shapeType","ShapeType","fills","push","x","colorShape","Oval","borderOptions","startArrowHead","endArrowHead","cellHeight","BASE_CELL_HEIGHT","Array","isArray","forEach","key","fontWeight","fixedWidth","charLimit","yAdjustment","Math","ceil","length","textLayers","colorGroup","Group","name","layers","find","Settings","message","UI","updatePaletteCell","parentLayerName","parentLayer","colorLayer","usageLayer","remove","addNewCell","cellToRemove","hasCellToRemove","lastLayer","layerBorders","PALETTE_NAME","height","cleanlyRemoveCell","isLastLayer","updatePaletteItem","document","previousColor","updatedColor","updatedThickness","sharedColors","documentSettingForKey","layerColors","colorData","undefined","setDocumentSettingForKey","loc","Document","onColorChange","context","getSelectedDocument","changePath","actionContext","internalFullPath","toString","trim","storedColorPathDict","hasPopulatedPalette","Object","keys","match","pageIndex","abIndex","layerAndStyleIndeces","styleType","updatedStyle","reduce","acc","itemIndex","index","arr","pages","thickness","split","item","strings","shared","title","subtitle","unique","fillsHeader","bordersHeader","messages","paletteBuilt","paletteUpdated"],"mappings":"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","file":"__onColorChange.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/onColorChange.js\");\n","import sketch from 'sketch';\nimport { BASE_CELL_HEIGHT } from '../utils/constants';\n\nexport function buildCellText(color, usages, thicknesses, localCoordinates) {\n    const thicknessPrefix = thicknesses ? `${thicknesses.join('px, ')}px ` : '';\n    const opacity = parseInt(color.substring(7, 9), 16) / 255;\n    const opacitySuffix = opacity < 1 ? ` (${opacity.toFixed(2).substring(1)} opacity)` : '';\n    const usagesString = `${usages} use${usages !== 1 ? 's' : ''}`;\n\n    return [\n        {\n            type: sketch.Types.Text,\n            text: `${thicknessPrefix}${color.substring(0, 7)}${opacitySuffix}`,\n            frame: new sketch.Rectangle(90, localCoordinates.y, 300, 20),\n            style: {\n                fontSize: 17,\n                fontFamily: 'PT Sans',\n                borders: [],\n            },\n        },\n        {\n            type: sketch.Types.Text,\n            text: usagesString,\n            frame: new sketch.Rectangle(90, localCoordinates.y + 20, 300, 20),\n            style: {\n                fontSize: 17,\n                fontFamily: 'PT Sans',\n                borders: [],\n            },\n        },\n    ]; // currently need to be last layers in group\n}\n\nexport default function buildPaletteCell([color, { sharedKeys, usages, thicknesses }], type, coordinates) {\n    let colorLayers = [];\n    const colorArr = [{ color }];\n    let colorFills = [];\n    let colorBorders = [];\n    if (type === 'border') {\n        colorBorders = colorArr;\n    } else {\n        colorFills = colorArr;\n    }\n\n    if (color.includes('#ffffff')) {\n        let whiteBg = {\n            type: sketch.Types.ShapePath,\n            shapeType: sketch.ShapePath.ShapeType.Rectangle,\n            style: {\n                fills: [\n                    {\n                        color: '#000000',\n                    },\n                ],\n                borders: [],\n            },\n            frame: new sketch.Rectangle(0, 0, 80, 80),\n        };\n        colorLayers.push(whiteBg);\n    }\n    let localCoordinates = {\n        x: 10,\n        y: 10,\n    };\n\n    const colorShape = {\n        type: sketch.Types.ShapePath,\n        shapeType: sketch.ShapePath.ShapeType.Oval,\n        style: {\n            fills: colorFills,\n            borders: colorBorders,\n            borderOptions: {\n                startArrowHead: 'FilledCircle',\n                endArrowHead: 'FilledCircle',\n            },\n        },\n        frame: new sketch.Rectangle(localCoordinates.x, localCoordinates.y, 60, 60),\n    };\n    colorLayers.push(colorShape);\n\n    let cellHeight = BASE_CELL_HEIGHT;\n\n    if (Array.isArray(sharedKeys)) {\n        sharedKeys.forEach((key) => {\n            colorLayers.push({\n                type: sketch.Types.Text,\n                text: key,\n                style: {\n                    fontSize: 17,\n                    fontWeight: 12,\n                    fontFamily: 'PT Sans',\n                    borders: [],\n                },\n                frame: new sketch.Rectangle(90, localCoordinates.y, 270, 20),\n                fixedWidth: true,\n            });\n\n            const charLimit = 33; // May need adjustments\n            const yAdjustment = Math.ceil(key.length / charLimit) * 20;\n            localCoordinates.y += yAdjustment;\n            cellHeight += yAdjustment;\n        });\n    }\n\n    localCoordinates.y += 10;\n\n    const textLayers = buildCellText(color, usages, thicknesses, localCoordinates);\n    colorLayers.push(...textLayers);\n\n    const colorGroup = new sketch.Group({\n        name: `${type}: ${color}`,\n        layers: colorLayers,\n    });\n    colorGroup.frame.y = coordinates.y;\n\n    coordinates.y += cellHeight;\n    return colorGroup;\n}\n","import sketch from 'sketch';\nimport buildPaletteCell, { buildCellText } from './buildPaletteCell';\nimport { BASE_CELL_HEIGHT, PALETTE_NAME } from '../utils/constants';\nimport loc from '../utils/loc';\n\nconst {\n    find,\n    Settings,\n    UI: { message },\n} = sketch;\n\nfunction updatePaletteCell(type, color, { usages, thicknesses }) {\n    const parentLayerName = `${type}: ${color}`;\n    const parentLayer = find(`[name=\"${parentLayerName}\"]`)[0];\n    const colorLayer = parentLayer.layers[parentLayer.layers.length - 2];\n    const usageLayer = parentLayer.layers[parentLayer.layers.length - 1];\n\n    const textLayers = buildCellText(color, usages, thicknesses, colorLayer.frame);\n\n    colorLayer.remove();\n    usageLayer.remove();\n    parentLayer.layers.push(...textLayers);\n}\n\nfunction addNewCell(color, type, cellToRemove) {\n    const hasCellToRemove = !!cellToRemove;\n    let parentLayer = find(`[name=\"layer_${type}s\"]`)[0];\n\n    const lastLayer = parentLayer.layers[parentLayer.layers.length - 1];\n\n    let y = lastLayer.frame.y + BASE_CELL_HEIGHT;\n    if (hasCellToRemove) {\n        y = cellToRemove.frame.y;\n        cellToRemove.remove();\n    } else {\n        if (type === 'fill') {\n            const layerBorders = find('[name=\"layer_borders\"]')[0];\n            layerBorders.frame.y += BASE_CELL_HEIGHT;\n        }\n\n        find(`[name=\"${PALETTE_NAME}\"]`)[0].frame.height += BASE_CELL_HEIGHT;\n    }\n\n    parentLayer.layers.push(buildPaletteCell(color, type, { y }));\n}\n\nfunction cleanlyRemoveCell(cellToRemove, type) {\n    if (!cellToRemove) {\n        return;\n    }\n\n    let parentLayer = find(`[name=\"layer_${type}s\"]`)[0];\n\n    const lastLayer = parentLayer.layers[parentLayer.layers.length - 1];\n    const isLastLayer = cellToRemove === lastLayer;\n\n    if (!isLastLayer) {\n        lastLayer.frame.y = cellToRemove.frame.y;\n    }\n\n    if (type === 'fill') {\n        const layerBorders = find('[name=\"layer_borders\"]')[0];\n        layerBorders.frame.y -= cellToRemove.frame.height;\n    }\n\n    cellToRemove.remove();\n}\n\nexport default function updatePaletteItem(document, previousColor, updatedColor, updatedThickness, type) {\n    let sharedColors = Settings.documentSettingForKey(document, `shared-${type}s`);\n    let layerColors = Settings.documentSettingForKey(document, `layer-${type}s`);\n    let cellToRemove;\n\n    if (sharedColors[previousColor]) {\n        sharedColors[previousColor].usages--;\n        updatePaletteCell(type, previousColor, sharedColors[previousColor]);\n    } else if (layerColors[previousColor]) {\n        if (layerColors[previousColor].usages > 1) {\n            layerColors[previousColor].usages--;\n            updatePaletteCell(type, previousColor, layerColors[previousColor]);\n        } else {\n            delete layerColors[previousColor];\n            cellToRemove = find(`[name=\"${type}: ${previousColor}\"]`)[0];\n        }\n    }\n\n    if (sharedColors[updatedColor]) {\n        sharedColors[updatedColor].usages++;\n        updatePaletteCell(type, updatedColor, sharedColors[updatedColor]);\n    } else if (layerColors[updatedColor]) {\n        layerColors[updatedColor].usages++;\n        updatePaletteCell(type, updatedColor, layerColors[updatedColor]);\n    } else {\n        const colorData = {\n            usages: 1,\n            thicknesses: type === 'border' ? [updatedThickness] : undefined,\n        };\n        layerColors[updatedColor] = colorData;\n        addNewCell([updatedColor, colorData], type, cellToRemove);\n        cellToRemove = undefined;\n    }\n\n    cleanlyRemoveCell(cellToRemove, type);\n\n    Settings.setDocumentSettingForKey(document, `shared-${type}s`, sharedColors);\n    Settings.setDocumentSettingForKey(document, `layer-${type}s`, layerColors);\n    message(loc('messages.paletteUpdated'));\n}\n","import sketch from 'sketch';\nimport updatePaletteItem from './methods/updatePaletteItem';\n\nconst { Settings, Document } = sketch;\n\n/* {\n    [color: string]: {\n        sharedKeys?: string[],\n        thicknesses?: number[]\n        usages: number\n    }\n} */\n\nexport function onColorChange(context) {\n    const document = Document.getSelectedDocument();\n    const changePath = context.actionContext[0].internalFullPath().toString().trim();\n\n    let storedColorPathDict = Settings.documentSettingForKey(document, 'color-path-dictionary');\n    let hasPopulatedPalette = !!storedColorPathDict && Object.keys(storedColorPathDict).length > 0;\n\n    if (!hasPopulatedPalette || changePath.match(/layers+/g).length < 2 || !changePath.includes('color')) return;\n\n    const [pageIndex, abIndex, ...layerAndStyleIndeces] = changePath.match(/\\d+/g);\n    const styleType = changePath.includes('border') ? 'border' : 'fill';\n\n    const updatedStyle = layerAndStyleIndeces.reduce((acc, itemIndex, index, arr) => {\n        if (index === arr.length - 1) {\n            // TODO: Account for border thickness changes\n            return acc.style[`${styleType}s`][itemIndex];\n        }\n        return acc.layers[itemIndex];\n    }, document.pages[pageIndex].layers[abIndex]);\n\n    const updatedColor = updatedStyle.color;\n    const updatedThickness = updatedStyle.thickness;\n\n    const previousColor = storedColorPathDict[changePath];\n    storedColorPathDict[changePath] = updatedColor;\n\n    Settings.setDocumentSettingForKey(document, 'color-path-dictionary', storedColorPathDict);\n\n    updatePaletteItem(document, previousColor, updatedColor, updatedThickness, styleType);\n}\n\nexport default onColorChange;\n","export const PALETTE_NAME = '🎨 Palette Cleanser';\n\nexport const BASE_CELL_HEIGHT = 95;\n","import strings from './strings';\n\nexport default function loc(key) {\n    return key.split('.').reduce((acc, item) => acc[item] || '', strings);\n}","export default {\n    shared: {\n        title: 'Layer Style Colors',\n        subtitle: 'These colors are from fills and borders in your Layer Styles. They can be easily reused and updated throughout your designs.'\n    },\n    unique: {\n        title: 'Unique Colors',\n        subtitle: 'These colors are from fills and borders in your document that aren\\'t part of a Layer Style. Unique styles can work for simple designs, but it\\'s hard to maintain a consistent palette as your design grows.'\n    },\n    fillsHeader: 'Fills',\n    bordersHeader: 'Borders',\n    messages: {\n        paletteBuilt: '🎉 Your palette is ready 🎉',\n        paletteUpdated: '✅ Palette updated ✅',\n    }\n}","module.exports = require(\"sketch\");"],"sourceRoot":""}